{"ast":null,"code":"import _toConsumableArray from\"K:/machine/rest_api/sync/html/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"K:/machine/rest_api/sync/html/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"K:/machine/rest_api/sync/html/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"K:/machine/rest_api/sync/html/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import axios from'axios';import TodoInput from\"./TodoInput\";import TodoSearch from\"./TodoSearch\";import Todo from\"./Todo\";import{Container,Row,Col}from\"react-bootstrap\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var BASE_URL=\"http://localhost:3333/api\";var TodoList=function TodoList(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),todos=_useState2[0],setTodos=_useState2[1];useEffect(function(){// サーバー側で CORS 対策していないと取得できない。\naxios.get(BASE_URL+'?user_id=1').then(function(res){return setTodos(res.data);});},[]);var onTodoSearch=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(searchText){var search_string,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:console.log(searchText);search_string=\"&searchtext=\"+searchText;_context.next=4;return axios.get(BASE_URL+'?user_id=1'+search_string).then(function(res){return setTodos(res.data);});case 4:result=_context.sent;case 5:case\"end\":return _context.stop();}},_callee);}));return function onTodoSearch(_x){return _ref.apply(this,arguments);};}();var onItemCreate=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(newItem,newContent){var params,result;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:// ただのjson body が空になる。ので以下を使用\nparams=new URLSearchParams();params.append('user_id',1);params.append('title',newItem);params.append('content',newContent);params.append('completed',false);// Send POST request;\n_context2.next=7;return axios.post(BASE_URL,params);case 7:result=_context2.sent;setTodos([].concat(_toConsumableArray(todos),[{title:newItem,content:newContent,completed:false,uuid:result.data.uuid}]));// Update my front-end\ncase 9:case\"end\":return _context2.stop();}},_callee2);}));return function onItemCreate(_x2,_x3){return _ref2.apply(this,arguments);};}();var onTodoDelete=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(todo){var index;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.delete(\"\".concat(BASE_URL,\"/\").concat(todo.uuid));case 2:index=todos.findIndex(function(i){return i.uuid===todo.uuid;});console.log(todos);setTodos([].concat(_toConsumableArray(todos.slice(0,index)),_toConsumableArray(todos.slice(index+1))));console.log(todos);case 6:case\"end\":return _context3.stop();}},_callee3);}));return function onTodoDelete(_x4){return _ref3.apply(this,arguments);};}();var onTodoUpdate=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(todo){var params;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:// put の場合でもURLSearchParams 使う必要があるみたい。\nparams=new URLSearchParams();params.append('completed',todo.completed);_context4.next=4;return axios.put(\"\".concat(BASE_URL,\"/\").concat(todo.uuid),params);case 4:case\"end\":return _context4.stop();}},_callee4);}));return function onTodoUpdate(_x5){return _ref4.apply(this,arguments);};}();// 空の場合はLoading\n// useEffect が変数への格納を監視している。\nif(todos===null)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading\"});return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{sm:4,children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsxs(Col,{children:[\"New Task\",/*#__PURE__*/_jsx(TodoInput,{onItemCreate:onItemCreate})]})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsxs(Col,{children:[\"Search Task\",/*#__PURE__*/_jsx(TodoSearch,{onTodoSearch:onTodoSearch})]})})]}),/*#__PURE__*/_jsxs(Col,{sm:8,children:[\"Task List\",/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{xs:1,className:\"border-bottom\",children:\"check\"}),/*#__PURE__*/_jsx(Col,{xs:1,className:\"border-bottom\",children:\"dell\"}),/*#__PURE__*/_jsx(Col,{className:\"border-bottom\",children:\"Task\"})]}),todos.map(function(todo){return/*#__PURE__*/_jsx(Todo,{todo:todo,onTodoDelete:onTodoDelete,onTodoUpdate:onTodoUpdate},todo.uuid);})]})]})]})});};export default TodoList;","map":{"version":3,"names":["useState","useEffect","axios","TodoInput","TodoSearch","Todo","Container","Row","Col","jsx","_jsx","jsxs","_jsxs","BASE_URL","TodoList","_useState","_useState2","_slicedToArray","todos","setTodos","get","then","res","data","onTodoSearch","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","searchText","search_string","result","wrap","_callee$","_context","prev","next","console","log","sent","stop","_x","apply","arguments","onItemCreate","_ref2","_callee2","newItem","newContent","params","_callee2$","_context2","URLSearchParams","append","post","concat","_toConsumableArray","title","content","completed","uuid","_x2","_x3","onTodoDelete","_ref3","_callee3","todo","index","_callee3$","_context3","delete","findIndex","i","slice","_x4","onTodoUpdate","_ref4","_callee4","_callee4$","_context4","put","_x5","children","sm","xs","className","map"],"sources":["K:/machine/rest_api/sync/html/client/src/components/TodoList.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport axios from 'axios';\r\nimport TodoInput from \"./TodoInput\";\r\nimport TodoSearch from \"./TodoSearch\";\r\nimport Todo from \"./Todo\";\r\nimport { Container, Row ,Col } from \"react-bootstrap\";\r\n\r\nconst BASE_URL = \"http://localhost:3333/api\";\r\n\r\n\r\nconst TodoList = () => {\r\n    const [todos, setTodos] = useState(null);\r\n        useEffect(() => {\r\n            // サーバー側で CORS 対策していないと取得できない。\r\n            axios.get(BASE_URL + '?user_id=1')\r\n            .then((res) => setTodos(res.data))\r\n        },[]\r\n    );\r\n\r\n    const onTodoSearch = async (searchText) =>{\r\n        console.log(searchText);\r\n        let search_string = \"&searchtext=\"+searchText;\r\n        const result = await axios.get(BASE_URL + '?user_id=1' + search_string).then((res) => setTodos(res.data))\r\n    }\r\n\r\n    const onItemCreate = async (newItem, newContent) =>{\r\n        // ただのjson body が空になる。ので以下を使用\r\n        const params = new URLSearchParams();\r\n        params.append('user_id', 1);\r\n        params.append('title', newItem);\r\n        params.append('content', newContent);\r\n        params.append('completed', false);\r\n\r\n        // Send POST request;\r\n        const result = await axios.post(BASE_URL, params);\r\n        setTodos([...todos, \r\n            {title: newItem, content: newContent, completed: false, uuid: result.data.uuid}])\r\n        // Update my front-end\r\n    }\r\n\r\n\r\n    const onTodoDelete = async (todo) => {\r\n        // update frondt-end\r\n        await axios.delete(`${BASE_URL}/${todo.uuid}`);\r\n        const index = todos.findIndex((i) => i.uuid  === todo.uuid);\r\n        console.log(todos);\r\n        setTodos([...todos.slice(0, index), ...todos.slice(index + 1 )]);\r\n        console.log(todos);\r\n    }\r\n\r\n    const onTodoUpdate = async (todo) => {\r\n        // put の場合でもURLSearchParams 使う必要があるみたい。\r\n        const params = new URLSearchParams();\r\n        params.append('completed', todo.completed );\r\n\r\n        await axios.put(\r\n            `${BASE_URL}/${todo.uuid}`, \r\n            params\r\n            );\r\n    }\r\n    // 空の場合はLoading\r\n    // useEffect が変数への格納を監視している。\r\n    if (todos === null) return <div>Loading</div>;\r\n\r\n    return (\r\n           <Container>\r\n                <Row>\r\n                    <Col sm={4}>\r\n                        <Row>\r\n                            <Col>\r\n                            New Task\r\n                            <TodoInput onItemCreate={onItemCreate} />\r\n                            </Col>\r\n                        </Row>\r\n                        <Row>\r\n                            <Col>\r\n                            Search Task\r\n                            <TodoSearch onTodoSearch={onTodoSearch}/>\r\n                            </Col>\r\n                        </Row>\r\n                    </Col>\r\n                    <Col sm={8}>\r\n                        Task List\r\n                    <Container>\r\n                        <Row>\r\n                            <Col xs={1} className=\"border-bottom\">check</Col>\r\n                            <Col xs={1} className=\"border-bottom\">dell</Col>\r\n                            <Col className=\"border-bottom\">Task</Col>\r\n                        </Row>\r\n                        {todos.map(( todo ) => (\r\n                                <Todo \r\n                                    key={todo.uuid} \r\n                                    todo={todo} \r\n                                    onTodoDelete={onTodoDelete} \r\n                                    onTodoUpdate={onTodoUpdate} \r\n                                />\r\n                            )\r\n                        )}\r\n                    </Container>\r\n                    </Col>\r\n                </Row>\r\n            </Container>\r\n    )\r\n};\r\n\r\nexport default TodoList;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}